<!doctype html>
<html lang="en">
<head>
		<meta charset="UTF-8">
		<title>Menuparser</title>
		<link rel="stylesheet" href="style.css">
</head>
<body>
	<h3>Menu</h3>
	<div class="submenu">			
		<ul>
			<li class="selected">
				<a href="#">Administrasjon</a>
				<ul>
					<li class="selected">
						<a href="#">Økonomi</a>
						<ul>
							<li>
								<a href="#">Eiendomsdrift</a>
							</li>
							<li class="selected active ">
								<a href="#">Personal</a>
							</li>
								<li>
								<a href="#">Finans</a>
							</li>
								<li class="">
								<a href="#">Regnskap</a>
							</li>
						</ul>
					</li>
				<li>
					<a href="#">Salg og Kunde</a>
				</li>
				<li class="">
					<a href="#">Service og kvalitet</a>
				</li>
				<li>
					<a href="#">Marked og forretningsstøtte</a>
				</li>
			</ul>
			</li>
			<li class="">
				<a href="#">Forvaltning</a>
				<ul>
					<li>ewfwef</li>
					<li>wefwefw</li>
					<li>wefwef</li>
					<li>wefwefw</li>
					<li>wefwefwe</li>
				</ul>
			</li>
			<li>
				<a href="#">Alle ansatte</a>
			</li>
			<li>
				<a href="#">Epinova</a>
			</li>
		</ul>
	</div>
	<div class="test">hello</div>
</body>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>
	$(document).ready(function() {
		function l(s) {
			console.log(s);
		}

		var MenuTree = {
			collapse: function(el) {
				el.toggle();
			},
			open: function() {
				$('a', '.submenu ul').each(function(i, elm) {
					var $a = $(this);
					var $li1 = $a.parent();

					if ($li1.hasClass('selected')) {
						//l("hello "+i+" > "+$(elm).text());
						$(elm).addClass("checked");
					} else {
						
					}

					if ($a.next().is('ul')) {
						var $ul = $a.next();
						var $li2 = $ul.children();
						if($li2.length>1) {
							$li2.each(function(j, e2){
								/*if ($(e2).hasClass('selected')) {
									$(e2).addClass('checked');
								}*/
							});
						}
						$a.click(function(e) {
							e.preventDefault();
							MenuTree.collapse($ul);
							$a.toggleClass("checked");
						});
					}
				});
			},
			check: function() {
				$('li', '.submenu ul').each(function(i, elm) {
					var $li = $(this);
					var $a = $li.children();

					if ($li.hasClass('selected')) {
						//l("> "+$a.first().text());
						$a.first().addClass('checked');

					} else {

					}
				});
			}
		}

		MenuTree.open();

		

		//parseMenu();
		$(".open").click(function(e) {
			e.preventDefault();
			
			if ($(this).siblings('ul').is(':visible')) {
				$(this).siblings("ul").fadeOut();
				$(this).removeClass("close").addClass("open");
			} else {
				$(this).siblings("ul").fadeIn();
				$(this).removeClass("open").addClass("close");
			}
			
		})
	});
</script>
</html>
